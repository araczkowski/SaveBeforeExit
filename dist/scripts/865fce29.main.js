"use strict";function revertOnChange(a,b,c,d){if(c!==b)if(apex.jQuery(document).apexSaveBeforeExit("modificationDetected")){apex.jQuery(document).apexSaveBeforeExit("modifiedItems",{highlight:!0});var e=window.confirm(d);e===!0?(window.onbeforeunload=function(){},apex.submit(a)):apex.item(a).setValue(c)}else apex.submit(a)}!function(a){a.widget("ui.apexSaveBeforeExit",{options:{saveMessage:null,noWarningSelector:null,disableTime:null,ignoreModificationsSelector:null,revertModificationsSelector:null,highlightModifiedItems:null,debug:0!==a("#pdebug").length},_createPrivateStorage:function(){var b=this;b.options.debug&&apex.debug("Save Before Exit: _createPrivateStorage (start)"),b._values={itemModified:!1,promptUser:!0,forcePrompt:!1},b._elements={$modifiedItems:a()},b.options.debug&&apex.debug("Save Before Exit: _createPrivateStorage (end)")},_create:function(){var b,c,d,e=this;if(e.options.debug){apex.debug("Save Before Exit: _create (start)"),apex.debug("...Options");for(var f in e.options)apex.debug("......"+f+': "'+e.options[f]+'"')}e._createPrivateStorage(),void 0!==e.options.ignoreModificationsSelector&&null!==e.options.ignoreModificationsSelector||(e.options.ignoreModificationsSelector=""),e.options.debug&&(b=a(e.options.ignoreModificationsSelector),b.length?b.each(function(){apex.debug('...Ignore modifications to: "'+this.nodeName+'"');for(var a in this.attributes)"function"!=typeof this.attributes[a]&&apex.debug("......"+this.attributes[a].nodeName+': "'+this.attributes[a].nodeValue+'"')}):apex.debug("...No elements selected to ignore modifications to")),apex.debug("revertModificationsSelector: "+e.options.revertModificationsSelector),void 0!==e.options.revertModificationsSelector&&null!==e.options.revertModificationsSelector||(e.options.revertModificationsSelector=""),e.options.debug&&(c=a(e.options.revertModificationsSelector),c.length?c.each(function(){apex.debug('...Ignore modifications to: "'+this.nodeName+'"');for(var a in this.attributes)"function"!=typeof this.attributes[a]&&apex.debug("......"+this.attributes[a].nodeName+': "'+this.attributes[a].nodeValue+'"')}):apex.debug("...No elements selected to ignore modifications to")),void 0!==e.options.noWarningSelector&&null!==e.options.noWarningSelector||(e.options.noWarningSelector=""),d=a(e.options.noWarningSelector),e.options.debug&&!d.length&&apex.debug("...No elements selected to allow leaving without warnings"),d.each(function(){var b=a(this),c=b.prop("onclick");if(e.options.debug){apex.debug('...Disable warnings for: "'+this.nodeName+'"');for(var d in this.attributes)"function"!=typeof this.attributes[d]&&apex.debug("......"+this.attributes[d].nodeName+': "'+this.attributes[d].nodeValue+'"')}c?b.removeAttr("onclick").prop("onclick",null).click(function(){e._disableWarningTemp(),c()}):b.click(function(){e._disableWarningTemp()})}),a(e.options.revertModificationsSelector).each(function(){var b,c,d=this.id;this.length?a(this).change(function(a){for(var f=0;f<this.length;f++)this.options[f].defaultSelected&&(b=this.options[f].value),this.options[f].selected&&(c=this.options[f].value);a.stopPropagation?a.stopPropagation():a.cancelBubble=!0,revertOnChange(d,c,b,e.options.saveMessage)}):a(this).click(function(f){a("[id^="+d+"]").each(function(){this.defaultChecked&&(b=this.value),this.checked&&(c=this.value)}),f.stopPropagation?f.stopPropagation():f.cancelBubble=!0,revertOnChange(d,c,b,e.options.saveMessage)})}),window.onbeforeunload=function(){if(e._values.forcePrompt)return a.browser.msie&&e._disableWarningTemp(),e.options.saveMessage;if(e._values.promptUser){if("Y"===e.options.highlightModifiedItems?e._detectModifications(!1,!0,!1):e._detectModifications(!0,!1,!1),e._values.itemModified===!1)return;if(a.browser.msie&&e._disableWarningTemp(),e._values.itemModified)return e.options.saveMessage}},a("form#wwvFlowForm fieldset.shuttle").not(e.options.ignoreModificationsSelector).each(function(){var b=$v(this.id);a(this).data("apex-sbe-load-val",b)}),e.options.debug&&apex.debug("Save Before Exit: _create (end)")},_disableWarningTemp:function(){var a=this;a.options.debug&&apex.debug("Save Before Exit: _disableWarningTemp (start)"),a._values.promptUser=!1,setTimeout(function(){a.enableWarning()},a.options.disableTime),a.options.debug&&apex.debug("Save Before Exit: _disableWarningTemp (end)")},_detectModifications:function(b,c,d){var e=this;return e.options.debug&&apex.debug("Save Before Exit: _detectModifications (start)"),e._values.itemModified=!1,e._elements.$modifiedItems=a(),c&&a(".apex-save-before-exit-highlight").removeClass("apex-save-before-exit-highlight"),a('form#wwvFlowForm input[type="text"],form#wwvFlowForm input[type="file"],form#wwvFlowForm input[type="password"],form#wwvFlowForm input[type="hidden"]').not(e.options.ignoreModificationsSelector).each(function(){return this.value!==this.defaultValue&&(e._values.itemModified=!0,d&&(e._elements.$modifiedItems=e._elements.$modifiedItems.add(this)),c&&a(this).addClass("apex-save-before-exit-highlight"),e.options.debug&&(apex.debug('...Modification detected on: "'+this.id+'"'),apex.debug('......Default Value: "'+this.defaultValue+'"'),apex.debug('......Current Value: "'+this.value+'"')),b)?!1:void 0}),b&&e._values.itemModified===!0?!0:(a('form#wwvFlowForm input[type="radio"],form#wwvFlowForm input[type="checkbox"]').not(e.options.ignoreModificationsSelector).each(function(){return this.checked!==this.defaultChecked&&(e._values.itemModified=!0,d&&(e._elements.$modifiedItems=e._elements.$modifiedItems.add(a(this).closest("fieldset"))),c&&a(this).closest("fieldset").addClass("apex-save-before-exit-highlight"),e.options.debug&&(apex.debug('...Modification detected on: "'+this.id+'"'),apex.debug('......Default Checked: "'+this.defaultChecked+'"'),apex.debug('......Current Checked: "'+this.checked+'"')),b)?!1:void 0}),b&&e._values.itemModified===!0?!0:(a("form#wwvFlowForm fieldset.shuttle").not(e.options.ignoreModificationsSelector).each(function(){var f=$v(this.id),g=a(this).data("apex-sbe-load-val");return void 0===g&&(g=""),f!==g&&(e._values.itemModified=!0,d&&(e._elements.$modifiedItems=e._elements.$modifiedItems.add(this)),c&&a(this).addClass("apex-save-before-exit-highlight"),e.options.debug&&(apex.debug('...Modification detected on: "'+this.id+'"'),apex.debug('......Default Value: "'+g+'"'),apex.debug('......Current Value: "'+f+'"')),b)?!1:void 0}),b&&e._values.itemModified===!0?!0:(a("form#wwvFlowForm select:not(.shuttle_left,.shuttle_right)").not(e.options.ignoreModificationsSelector).each(function(){for(var f=0;f<this.length;f++)if(this.options[f].selected!==this.options[f].defaultSelected&&(e._values.itemModified=!0,d&&(e._elements.$modifiedItems=e._elements.$modifiedItems.add(this)),c&&a(this).addClass("apex-save-before-exit-highlight"),e.options.debug&&(apex.debug('...Modification detected on: "'+this.id+'" ('+this.options[f].text+")"),apex.debug('......Default Selected: "'+this.options[f].defaultSelected+'"'),apex.debug('......Current Selected: "'+this.options[f].selected+'"')),b))return!1}),b&&e._values.itemModified===!0?!0:(a("form#wwvFlowForm textarea:not(.rich_text_editor)").not(e.options.ignoreModificationsSelector).each(function(){return this.value!==this.defaultValue&&(e._values.itemModified=!0,d&&(e._elements.$modifiedItems=e._elements.$modifiedItems.add(this)),c&&a(this).addClass("apex-save-before-exit-highlight"),e.options.debug&&(apex.debug('...Modification detected on: "'+this.id+'"'),apex.debug('......Default Value: "'+this.defaultValue+'"'),apex.debug('......Current Value: "'+this.value+'"')),b)?!1:void 0}),b&&e._values.itemModified===!0?!0:void a("form#wwvFlowForm textarea.rich_text_editor").not(e.options.ignoreModificationsSelector).each(function(){try{if(CKEDITOR.instances[this.id].checkDirty()&&(e._values.itemModified=!0,d&&(e._elements.$modifiedItems=e._elements.$modifiedItems.add(this)),c&&a(this).closest("td").addClass("apex-save-before-exit-highlight"),e.options.debug&&(apex.debug('...Modification detected on: "'+this.id+'"'),apex.debug('......Default Value: "'+this.defaultValue+'"'),apex.debug('......Current Value: "'+CKEDITOR.instances[this.id].getData()+'"')),b))return!1}catch(f){console.log(f)}})))))},modificationDetected:function(){var a=this;return a.options.debug&&apex.debug("Save Before Exit: modificationDetected (start)"),a._detectModifications(!0,!1,!1),a.options.debug&&apex.debug("Save Before Exit: modificationDetected (end)"),a._values.itemModified},modifiedItems:function(b){var c=this,d={highlight:!1},e=a.extend(d,b);return c.options.debug&&apex.debug("Save Before Exit: modifiedItems (start)"),c._detectModifications(!1,e.highlight,!0),c.options.debug&&apex.debug("Save Before Exit: modifiedItems (end)"),c._elements.$modifiedItems},destroy:function(){var b=this;b.options.debug&&apex.debug("Save Before Exit: destroy (start)"),window.onbeforeunload=function(){},a.Widget.prototype.destroy.call(b),b.options.debug&&apex.debug("Save Before Exit: destroy (end)")},getOptions:function(){var a=this;return a.options},resetModifiedItems:function(){var b=this;b.options.debug&&apex.debug("Save Before Exit: resetModifiedItems (start)"),a('form#wwvFlowForm input[type="text"],form#wwvFlowForm input[type="file"],form#wwvFlowForm input[type="password"],form#wwvFlowForm input[type="hidden"]').not(b.options.ignoreModificationsSelector).each(function(){this.defaultValue=this.value}),b._values={itemModified:!1,promptUser:!0,forcePrompt:!1},b._elements={$modifiedItems:a()},a(".apex-save-before-exit-highlight").removeClass("apex-save-before-exit-highlight"),b.options.debug&&apex.debug("Save Before Exit: resetModifiedItems (end)")},enableWarning:function(){var a=this;a.options.debug&&apex.debug("Save Before Exit: enableWarning (start)"),a._values.promptUser=!0,a.options.debug&&apex.debug("Save Before Exit: enableWarning (end)")},disableWarning:function(){var a=this;a.options.debug&&apex.debug("Save Before Exit: disableWarning (start)"),a._values.promptUser=!1,a.options.debug&&apex.debug("Save Before Exit: disableWarning (end)")},enableWarningForce:function(){var a=this;a.options.debug&&apex.debug("Save Before Exit: enableWarningForce (start)"),a._values.forcePrompt=!0,a.options.debug&&apex.debug("Save Before Exit: enableWarningForce (end)")},disableWarningForce:function(){var a=this;a.options.debug&&apex.debug("Save Before Exit: disableWarningForce (start)"),a._values.forcePrompt=!1,a.options.debug&&apex.debug("Save Before Exit: disableWarningForce (end)")},warningForceEnabled:function(){var a=this;return a.options.debug&&apex.debug("Save Before Exit: warningForceEnabled (start/end)"),a._values.forcePrompt}})}(apex.jQuery);